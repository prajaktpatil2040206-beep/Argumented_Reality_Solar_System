<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Live Camera + Sensors</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: black;
            color: white;
        }
        #video-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            z-index: 0;
            pointer-events: none;
        }
        #overlay {
            position: absolute;
            top: 20px;
            left: 20px;
            right: 20px;
            bottom: 20px;
            z-index: 1;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            pointer-events: none; /* allow clicks to pass to button if needed */
        }
        #sensor-data {
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(10px);
            padding: 20px;
            border-radius: 24px;
            border: 1px solid rgba(255,255,255,0.2);
            width: fit-content;
            max-width: 90%;
            align-self: flex-start;
            font-size: 16px;
            line-height: 1.6;
            box-shadow: 0 8px 20px rgba(0,0,0,0.5);
            color: #fff;
            text-shadow: 0 2px 4px black;
            pointer-events: auto; /* allow selection if needed */
        }
        #sensor-data div {
            margin: 4px 0;
        }
        .badge {
            color: #ffd966;
            font-weight: 600;
        }
        #permission-btn {
            background: #1e2a3a;
            color: white;
            border: 2px solid #4aa3ff;
            border-radius: 40px;
            padding: 14px 28px;
            font-size: 18px;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(0,0,0,0.5);
            cursor: pointer;
            pointer-events: auto;
            align-self: center;
            margin-bottom: 30px;
            width: fit-content;
            backdrop-filter: blur(8px);
            background: rgba(30,40,60,0.9);
            border: 1px solid #4aa3ff;
        }
        #status {
            color: #ccc;
            font-size: 14px;
            margin-top: 10px;
        }
        .footer {
            align-self: flex-end;
            background: rgba(0,0,0,0.4);
            backdrop-filter: blur(5px);
            padding: 10px 20px;
            border-radius: 40px;
            font-size: 14px;
            text-align: center;
            border: 1px solid rgba(255,255,255,0.2);
            width: fit-content;
            margin: 0 auto;
        }
    </style>
</head>
<body>
    <video id="video-bg" autoplay playsinline></video>
    
    <div id="overlay">
        <div id="sensor-data">
            <div><span class="badge">ğŸ“± Orientation (degrees)</span></div>
            <div>ğŸ”µ Alpha (heading): <span id="alpha">0</span>Â°</div>
            <div>ğŸŸ¢ Beta (tilt front/back): <span id="beta">0</span>Â°</div>
            <div>ğŸ”´ Gamma (tilt left/right): <span id="gamma">0</span>Â°</div>
            <div style="margin-top:12px;"><span class="badge">âš¡ Motion</span></div>
            <div>ğŸ“Š Acceleration (m/sÂ²):</div>
            <div>Â Â X: <span id="accelX">0</span>, Y: <span id="accelY">0</span>, Z: <span id="accelZ">0</span></div>
            <div>ğŸŒ With gravity:</div>
            <div>Â Â X: <span id="accelGX">0</span>, Y: <span id="accelGY">0</span>, Z: <span id="accelGZ">0</span></div>
            <div>ğŸŒ€ Rotation rate (Â°/s):</div>
            <div>Â Â Î±: <span id="rotAlpha">0</span>, Î²: <span id="rotBeta">0</span>, Î³: <span id="rotGamma">0</span></div>
            <div>â±ï¸ Interval: <span id="interval">0</span> ms</div>
            <div id="status">ğŸ”„ Initializing sensors...</div>
        </div>
        
        <button id="permission-btn" style="display: none;">ğŸ”˜ Enable Motion Sensors</button>
        
        <div class="footer">
            ğŸ“· Live camera background | Sensors: gyroscope + accelerometer
        </div>
    </div>

    <script>
        (function() {
            // Get DOM elements
            const video = document.getElementById('video-bg');
            const alphaSpan = document.getElementById('alpha');
            const betaSpan = document.getElementById('beta');
            const gammaSpan = document.getElementById('gamma');
            const accelXSpan = document.getElementById('accelX');
            const accelYSpan = document.getElementById('accelY');
            const accelZSpan = document.getElementById('accelZ');
            const accelGXSpan = document.getElementById('accelGX');
            const accelGYSpan = document.getElementById('accelGY');
            const accelGZSpan = document.getElementById('accelGZ');
            const rotAlphaSpan = document.getElementById('rotAlpha');
            const rotBetaSpan = document.getElementById('rotBeta');
            const rotGammaSpan = document.getElementById('rotGamma');
            const intervalSpan = document.getElementById('interval');
            const statusDiv = document.getElementById('status');
            const permissionBtn = document.getElementById('permission-btn');

            // Camera stream
            async function startCamera() {
                try {
                    const stream = await navigator.mediaDevices.getUserMedia({ 
                        video: { facingMode: 'environment' }, // rear camera
                        audio: false 
                    });
                    video.srcObject = stream;
                    statusDiv.innerHTML = 'âœ… Camera active';
                } catch (err) {
                    statusDiv.innerHTML = 'âŒ Camera access denied';
                    console.error(err);
                }
            }
            startCamera();

            // Sensor data handlers
            function handleOrientation(event) {
                if (event.alpha !== null) {
                    alphaSpan.textContent = event.alpha.toFixed(1);
                } else {
                    alphaSpan.textContent = 'N/A';
                }
                if (event.beta !== null) {
                    betaSpan.textContent = event.beta.toFixed(1);
                } else {
                    betaSpan.textContent = 'N/A';
                }
                if (event.gamma !== null) {
                    gammaSpan.textContent = event.gamma.toFixed(1);
                } else {
                    gammaSpan.textContent = 'N/A';
                }
            }

            function handleMotion(event) {
                const accel = event.acceleration;
                const accelG = event.accelerationIncludingGravity;
                const rotRate = event.rotationRate;
                const interval = event.interval;

                if (accel) {
                    accelXSpan.textContent = accel.x !== null ? accel.x.toFixed(2) : '0';
                    accelYSpan.textContent = accel.y !== null ? accel.y.toFixed(2) : '0';
                    accelZSpan.textContent = accel.z !== null ? accel.z.toFixed(2) : '0';
                } else {
                    accelXSpan.textContent = 'N/A';
                    accelYSpan.textContent = 'N/A';
                    accelZSpan.textContent = 'N/A';
                }

                if (accelG) {
                    accelGXSpan.textContent = accelG.x !== null ? accelG.x.toFixed(2) : '0';
                    accelGYSpan.textContent = accelG.y !== null ? accelG.y.toFixed(2) : '0';
                    accelGZSpan.textContent = accelG.z !== null ? accelG.z.toFixed(2) : '0';
                } else {
                    accelGXSpan.textContent = 'N/A';
                    accelGYSpan.textContent = 'N/A';
                    accelGZSpan.textContent = 'N/A';
                }

                if (rotRate) {
                    rotAlphaSpan.textContent = rotRate.alpha !== null ? rotRate.alpha.toFixed(2) : '0';
                    rotBetaSpan.textContent = rotRate.beta !== null ? rotRate.beta.toFixed(2) : '0';
                    rotGammaSpan.textContent = rotRate.gamma !== null ? rotRate.gamma.toFixed(2) : '0';
                } else {
                    rotAlphaSpan.textContent = 'N/A';
                    rotBetaSpan.textContent = 'N/A';
                    rotGammaSpan.textContent = 'N/A';
                }

                intervalSpan.textContent = interval ? interval.toFixed(2) : '0';
            }

            // Permission handling for iOS 13+
            if (typeof DeviceOrientationEvent !== 'undefined' && typeof DeviceOrientationEvent.requestPermission === 'function') {
                // iOS requires explicit permission
                permissionBtn.style.display = 'inline-block';
                permissionBtn.addEventListener('click', async () => {
                    try {
                        const response = await DeviceOrientationEvent.requestPermission();
                        if (response === 'granted') {
                            window.addEventListener('deviceorientation', handleOrientation);
                            window.addEventListener('devicemotion', handleMotion);
                            statusDiv.innerHTML = 'âœ… Sensors enabled';
                            permissionBtn.style.display = 'none';
                        } else {
                            statusDiv.innerHTML = 'âŒ Sensor permission denied';
                        }
                    } catch (err) {
                        statusDiv.innerHTML = 'âŒ Error requesting permission';
                        console.error(err);
                    }
                });
            } else {
                // Non-iOS or older iOS â€” just add listeners
                window.addEventListener('deviceorientation', handleOrientation);
                window.addEventListener('devicemotion', handleMotion);
                permissionBtn.style.display = 'none';
                statusDiv.innerHTML = 'âœ… Sensors active';
            }

            // Update status if sensors don't fire after a while
            setTimeout(() => {
                if (alphaSpan.textContent === '0' && betaSpan.textContent === '0' && gammaSpan.textContent === '0') {
                    statusDiv.innerHTML = 'âš ï¸ No orientation data (sensors might be missing)';
                }
            }, 3000);
        })();
    </script>
</body>
</html>